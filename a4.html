<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, maximum-scale=1.0" />

    <title>A4: Libraries!</title>

    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <h1>Assignment 4: Libraries!</h1>
    <div class="header" style="text-align: center;">
      <img src="A4_electricity.png" class="center"/>
    </div>
    <br>
    <h2>Schematics & Calculations!</h2>
    <div class="section1">
      <img src="A3_scheme.jpg" 
        width="488" 
        height="360"
        style="display:inline-block;"
      />
      <img src="A3_Calc.jpg" 
        width="419" 
        height="360"
        style="display:inline-block;"
      />
      <p>The schematic used to create the LED circuit. Calculations used to find
        the correct resistors to use for each LED color and photoresistor. A 220 ohm resistor is used
        on the photoresistor because this resistors is used to ground both red and blue LEDs. An additional
        10 ohm resistor is used on the RGB red LED to ground the LED and allow for more light from the blue LED.
        The calculations above also show the potential values at the voltage divider based on a bright room or dark room.
      </p>
    </div>
    <br>
    <h2>Firmware!</h2>
    <div class="section2">
      <pre>
        // Using Arduino libraries Capacitive Sensor and Servo Motor
        #include <CapacitiveSensor.h>
        #include <Servo.h>

        // create a servo object
        Servo myServo;  

        // 1 megohm resistor between pins 4 & 2, pin 2 is sensor pin, add wire, metal thing
        CapacitiveSensor   cs_4_2 = CapacitiveSensor(4,2);   

        // Initializing Servo Motor and Capacitive Sensor
        void setup() {
            cs_4_2.set_CS_AutocaL_Millis(0xFFFFFFFF); 	// turn off autocalibrate on channel 1 - just as an example
            myServo.attach(9); // attaches the servo on pin 9 to the servo object
            Serial.begin(9600);
        }

        // Gets data from capacitive sensor to signal aervo motor to turn
        void loop() {

            // Reads and detects signal from capacitive sensor and outputs data
            long start = millis();
            long total1 =  cs_4_2.capacitiveSensor(30);

            // if the capacitive sensor signals over 300 (when touched) then servo motor will rotate 180 degrees
            if (total1 >= 300) {
                myServo.write(180);
            } else {
                myServo.write(0);
            }

            Serial.print(millis() - start);    	// check on performance in milliseconds
            Serial.print("\t");                	// tab character for debug window spacing

            Serial.println(total1);            	// print sensor output 1
            delay(10);                         	// arbitrary delay to limit data to serial port
        }
      </pre>
    </div>
    <br>
    <h2>Circuits!</h2>
    <div class="section3">
      <img src="A4_ciruit.JPG" 
        width="380" 
        height="420"
        style="display:inline-block;"
      />
      <img src="A4_gif.gif" width="336" height="420" allowFullScreen  style="display:inline-block;"></img>
      <p>Here is the finished working product! In the picture and GIF above, there are 2 LEDs (red and purple)
        using a 220 ohm resistor and a photoresistor. Each LED blinks depending on the light in the environment. 
        In this case, when it is at a normal light level (room light) the red LED is on. When there is an excessive
        amount of light, the purple LED turns on. 
      </p>
    </div>
    <br>
    <h2>Questions!</h2>
    <div class="section4">
      <ol> 
        <li>Say you are using a servo motor you attach to pin 9.Draw a graph with the X axis in seconds, for two seconds, and the y-axis the voltage at pin 9 with respect to ground. </li>
        <img src="A3_Q1.jpg"/>
        <p>As you can see, in both scenarios, the voltage at the output varies with the resistance of the variable resistor (photoresistor),
            and the circuit functions as a voltage divider. The choice of which resistor is variable depends on the desired behavior and the 
            physical characteristics of the components used. With that being said, the variable resistor could be either R1 or R2 (backed by calculations).
        </p>
        <br>
        <li> Your input device is slightly broken, leading it to give us an erroneous reading 1% of the time. How can we address this? Answer in (pseudo)code.</li>
        <img src="A3_Q2.jpg"/>
        <br>
        <li>Your input device is slightly noisy, leading the measurement to randomly deviate from the true measurement up or down by 10%. How can we address this? Answer in (pseudo)code.</li>
        <dd>- If you had a 10-bit PWM resolution and a 16-bit analog-to-digital converter (ADC) instead of the standard 8-bit and 10-bit, respectively, 
            you would need to adjust the parameters used in the map() function in your code.   
        </dd>
      </ol>
    </div>
  </body>
</html>
